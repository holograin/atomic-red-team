# T1547.013 - Boot or Logon Autostart Execution: XDG Autostart Entries
## [Description from ATT&CK](https://attack.mitre.org/techniques/T1547/013)
<blockquote>Adversaries may add or modify XDG Autostart Entries to execute malicious programs or commands when a user’s desktop environment is loaded at login. XDG Autostart entries are available for any XDG-compliant Linux system. XDG Autostart entries use Desktop Entry files (`.desktop`) to configure the user’s desktop environment upon user login. These configuration files determine what applications launch upon user login, define associated applications to open specific file types, and define applications used to open removable media.(Citation: Free Desktop Application Autostart Feb 2006)(Citation: Free Desktop Entry Keys)

Adversaries may abuse this feature to establish persistence by adding a path to a malicious binary or command to the `Exec` directive in the `.desktop` configuration file. When the user’s desktop environment is loaded at user login, the `.desktop` files located in the XDG Autostart directories are automatically executed. System-wide Autostart entries are located in the `/etc/xdg/autostart` directory while the user entries are located in the `~/.config/autostart` directory.

Adversaries may combine this technique with [Masquerading](https://attack.mitre.org/techniques/T1036) to blend malicious Autostart entries with legitimate programs.(Citation: Red Canary Netwire Linux 2022)</blockquote>

## Atomic Tests

- [Atomic Test #1 - Linux - Modification of Autostart Entries](#atomic-test-1---linux---modification-of-autostart-entries)


<br/>

## Atomic Test #1 - Linux - Modification of Autostart Entries
Simulates the creation or modification of files in common Linux autostart directories to emulate an adversary establishing persistence.

**Supported Platforms:** Linux


**auto_generated_guid:** ef5ffc8c-c399-43f2-8b2e-1910a493292b






#### Attack Commands: Run with `bash`! 


```bash
# Example modification in the user's home autostart directory
echo -e '[Desktop Entry]
Type=Application
Exec=malicious_command' > ~/.config/autostart/malicious.desktop

# Example modification in the system-wide autostart directory (requires elevated permissions)
# echo '[Desktop Entry]
# Type=Application
# Exec=malicious_command' | sudo tee /etc/xdg/autostart/malicious.desktop > /dev/null

echo Autostart entry is created at "~/.config/autostart/malicious.desktop"
```




#### Dependencies:  Run with `bash`!
##### Description: Access to user's home directory and/or the ability to create files in system-wide autostart directories.
##### Check Prereq Commands:
```bash
[ -d ~/.config/autostart ]
```
##### Get Prereq Commands:
```bash
mkdir -p ~/.config/autostart && echo "User autostart directory created."
```




<br/>
